# 会话层-基本概念

[[toc]]

## 基本概念

1. 定位 ​：位于传输层与应用层之间，位于 OSI 模型的第 5 层，负责建立、管理、终止应用程序之间的会话（Session），并同步数据交换。

::: tip 与传输层的区别

- 传输层（TCP/UDP）负责端到端的数据传输。
- 会话层负责高层逻辑会话 ​（如用户登录、文件传输会话）。

:::

## 核心功能

| 功能           | 说明                                                                     |
| -------------- | ------------------------------------------------------------------------ |
| 会话建立与终止 | 协调多方通信的开始和结束（如 TCP 三次握手后，会话层管理应用层握手）。    |
| 会话同步       | 插入检查点（Checkpoint），若传输中断可从最近检查点恢复（如大文件上传）。 |
| 令牌管理       | 控制对话权限（如半双工通信中通过令牌决定哪一方可发送数据）。             |
| 异常恢复       | 在会话中断后尝试恢复连接（如数据库会话超时重连）。                       |

## 应用层实现会话层

::: warning 会话层在 OSI 中是一种理论模型
OSI 会话层是理论模型，现代开发中其功能通常由应用层协议（如 `WebSocket`）或框架（如 `Spring Session`）实现
:::

比如 session 机制就是 java 对应会话层的一种实现：
![会话层实现](https://image-bucket-1307756649.cos.ap-chengdu.myqcloud.com/image/20250713114205534.png)

再比如 websocket,属于应用层协议，但实现了 OSI 会话层的核心功能（会话 ID、状态维护、异常恢复）

```js
// 建立会话
const socket = new WebSocket('wss://api.example.com/chat');
// 会话ID获取（实际可能通过首条消息返回）
socket.onmessage = e => {
  if (e.data.session_id) localStorage.setItem('ws_session', e.data.session_id);
};
```
