# 简单工厂模式

[[toc]]

## 角色/类图

| **角色**                          | **职责**                                                                                         |
| --------------------------------- | ------------------------------------------------------------------------------------------------ |
| **工厂类（Factory）**             | 负责根据传入参数创建并返回具体产品对象。包含核心逻辑判断（如 `switch` 或 `if/else`）。           |
| **抽象产品类（Product）**         | 定义产品的接口（方法如 `operation()`），供具体产品实现。在 JavaScript 中常省略，直接用对象替代。 |
| **具体产品类（ConcreteProduct）** | 实现抽象产品接口的具体类（如 `Admin`、`User`）。每个类代表一种产品类型。                         |

## 示例代码

```javascript
// 工厂类
class UserFactory {
  static createUser(type) {
    switch (type) {
      case 'admin':
        return new Admin();
      case 'user':
        return new User();
      default:
        throw new Error('Invalid user type');
    }
  }
}

// 抽象产品类（JavaScript 中通常用父类或接口定义）
class User {
  getPermissions() {
    throw new Error('Abstract method must be implemented');
  }
}

// 具体产品类
class Admin extends User {
  getPermissions() {
    return { read: true, write: true, delete: true };
  }
}

// 使用
const admin = UserFactory.createUser('admin');
console.log(admin.getPermissions()); // { read: true, write: true, delete: true }
```

## 优点

| **优点**               | **说明**                                           |
| ---------------------- | -------------------------------------------------- |
| **解耦对象创建与使用** | 客户端无需关心对象如何创建，只需调用工厂方法。     |
| **集中管理创建逻辑**   | 所有对象的创建逻辑集中在工厂类中，便于维护和修改。 |
| **简化客户端代码**     | 客户端代码更简洁，只需传递参数即可获取所需对象。   |
| **易于扩展默认配置**   | 可通过工厂类统一管理默认参数或全局配置。           |

## 缺点

| **缺点**               | **说明**                                                             |
| ---------------------- | -------------------------------------------------------------------- |
| **违反开闭原则**       | 新增产品类型需修改工厂类代码（如添加 `case` 分支）。                 |
| **工厂类职责过重**     | 工厂类可能因产品类型过多而变得臃肿。                                 |
| **不易扩展复杂产品族** | 若产品间存在复杂依赖或组合，简单工厂难以处理（需改用抽象工厂模式）。 |

## **适用场景**

| **场景**               | **示例**                                                         |
| ---------------------- | ---------------------------------------------------------------- |
| **对象类型较少且固定** | 用户角色（Admin/User）、日志记录器（FileLogger/ConsoleLogger）。 |
| **创建逻辑简单**       | 直接根据参数 `new` 对象，无需复杂初始化。                        |
| **不频繁新增产品类型** | 产品类型变化周期长，可接受偶尔修改工厂类。                       |

## 总结

简单工厂模式通过 **单一工厂类** 封装对象创建逻辑，是设计模式中最基础、最易理解的一种。尽管其存在 **违反开闭原则** 的缺点，但在以下场景中仍具优势：

- 产品类型有限且稳定。
- 无需频繁扩展新产品。
- 需要快速实现对象创建解耦。

对于需要高度扩展性的场景，建议升级为 **工厂方法模式** 或 **抽象工厂模式**。
