# 超分模型学习

[[toc]]

参考
【1】：https://blog.csdn.net/prinstinadl/article/details/80825638

## SRCNN

[论文地址](http://personal.ie.cuhk.edu.hk/~ccloy/files/eccv_2014_deepresolution.pdf)

SRCNN 是深度学习用在超分辨率重建上的开山之作。SRCNN 的网络结构非常简单，仅仅用了三个卷积层，网络结构如下图所示。

![SRCNN ](https://image-bucket-1307756649.cos.ap-chengdu.myqcloud.com/image/20250926103100561.png)

SRCNN 首先使用双三次(bicubic)插值将低分辨率图像放大成目标尺寸，接着通过三层卷积网络拟合非线性映射，最后输出高分辨率图像结果。本文中，作者将三层卷积的结构解释成三个步骤：图像块的提取和特征表示，特征非线性映射和最终的重建。

三个卷积层使用的卷积核的大小分为为 9x9,，1x1 和 5x5，前两个的输出特征个数分别为 64 和 32。用 Timofte 数据集（包含 91 幅图像）和 ImageNet 大数据集进行训练。使用均方误差(Mean Squared Error, MSE)作为损失函数，有利于获得较高的 PSNR。

::: tip 相关概念
卷积网络是一种模仿人类视觉系统设计的深度学习模型，核心是用 “卷积” 操作替代传统的全连接，擅长处理图像、视频等网格状数据。

1. 核心作用：自动从图像中提取有用信息（比如边缘、纹理、颜色），再用这些信息完成任务（比如超分、识别）。
2. 为什么适合图像：它能保留图像的空间结构（比如像素的位置关系），而不像传统方法那样把图像拆成孤立的数字。
3. 类比理解：就像人看画，先看到线条（低级特征），再看到形状（中级特征），最后认出物体（高级特征），卷积网络也是这样分层提取特征的。

非线性映射是让卷积网络能处理复杂问题的关键，作用是 “打破线性关系，让模型能学习更灵活的规律”。

1. “映射” 的含义：在这里就是 “低分辨率图像的特征 → 高分辨率图像的特征” 的转换过程。
2. 为什么需要 “非线性”：如果没有非线性，再多的卷积层也相当于一层，无法学习到复杂的细节（比如不同场景的纹理差异）。常用的非线性函数有 ReLU、Sigmoid 等。

卷积核是卷积网络里的 “工具”，本质是一个很小的数值矩阵（比如 SRCNN 里的 9x9、1x1、5x5），负责在图像上 “滑动” 并提取特征。

1. 核心作用：像 “滤镜” 一样，每次滑动都对图像的一个小区域（和核大小相同）做计算，输出新的特征值。
2. 不同大小的核有什么用：
   - 大核（如 9x9）：覆盖的图像区域大，适合提取图像的 “全局信息” 或 “大尺度特征”（比如整体轮廓）。
   - 小核（如 1x1）：不改变图像尺寸，主要用来调整特征的数量（比如 SRCNN 里用 1x1 核把 64 个特征降到 32 个），减少计算量。
   - 中等核（如 5x5）：平衡局部细节和计算量，适合对提取到的特征做进一步处理，最终生成高分辨率图像。
3. 类比理解：就像用不同尺寸的画笔作画，大刷子刷底色，小画笔勾细节，1x1 的核就像调色盘，调整颜色的种类。

:::

## FSRCNN

[论文地址](https://arxiv.org/abs/1608.00367)
[代码地址](http://mmlab.ie.cuhk.edu.hk/projects/FSRCNN.html)

FSRCNN 与 SRCNN 都是香港中文大学 Dong Chao， Xiaoou Tang 等人的工作。FSRCNN 是对之前 SRCNN 的改进，主要在三个方面：

1. 是在最后使用了一个反卷积层放大尺寸，因此可以直接将原始的低分辨率图像输入到网络中，而不是像之前 SRCNN 那样需要先通过 bicubic 方法放大尺寸。
2. 是改变特征维数，使用更小的卷积核和使用更多的映射层。
3. 是可以共享其中的映射层，如果需要训练不同上采样倍率的模型，只需要 fine-tuning 最后的反卷积层。

由于 FSRCNN 不需要在网络外部进行放大图片尺寸的操作，同时通过添加收缩层和扩张层，将一个大层用一些小层来代替，因此 FSRCNN 与 SRCNN 相比有较大的速度提升。FSRCNN 在训练时也可以只 fine-tuning 最后的反卷积层，因此训练速度也更快。FSRCNN 与 SCRNN 的结构对比如下图所示。

![FSRCNN](https://image-bucket-1307756649.cos.ap-chengdu.myqcloud.com/image/20250926110448302.png)

FSRCNN 可以分为五个部分。特征提取

1. SRCNN 中针对的是插值后的低分辨率图像，选取的核大小为 9×9，这里直接是对原始的低分辨率图像进行操作，因此可以选小一点，设置为 5×5。
2. 收缩：通过应用 1×1 的卷积核进行降维，减少网络的参数，降低计算复杂度。
3. 非线性映射：感受野大，能够表现的更好。SRCNN 中，采用的是 5×5 的卷积核，但是 5×5 的卷积核计算量会比较大。用两个串联的 3×3 的卷积核可以替代一个 5×5 的卷积核，同时两个串联的小卷积核需要的参数 3×3×2=18 比一个大卷积核 5×5=25 的参数要小。FSRCNN 网络中通过 m 个核大小为 3×3 的卷积层进行串联。
4. 扩张：作者发现低维度的特征带来的重建效果不是太好，因此应用 1×1 的卷积核进行扩维，相当于收缩的逆过程。
5. 反卷积层：可以堪称是卷积层的逆操作，如果步长为 n，那么尺寸放大 n 倍，实现了上采样的操作。

FSRCNN 中激活函数采用 PReLU，损失函数仍然是均方误差。对 CNN 来说，Set91 并不足够去训练大的网络结构，FSRCNN 提出 general-100 + Set91 进行充当训练集。并且进行数据增强，1）缩小尺寸为原来的 0.9, 0.8, 0.7 和 0.6。2）旋转 90°，180° 和 270°，因此获得了数据量的提升。

## ESPCN

[论文地址](https://arxiv.org/abs/1609.05158)

作者在本文中介绍到，像 SRCNN 那样的方法，由于需要将低分辨率图像通过上采样插值得到与高分辨率图像相同大小的尺寸，再输入到网络中，这意味着要在较高的分辨率上进行卷积操作，从而增加了计算复杂度。本文提出了一种直接在低分辨率图像尺寸上提取特征，计算得到高分辨率图像的高效方法。ESPCN 网络结构如下图所示

![ESPCN](https://image-bucket-1307756649.cos.ap-chengdu.myqcloud.com/image/20250926113532414.png)
