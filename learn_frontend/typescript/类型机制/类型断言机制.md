# 类型断言机制

[[toc]]

## 类型断言

有些情况下，变量的类型对于我们来说是很明确，但是 TS 编译器却并不清楚，此时，可以通过类型断言来告诉编译器变量的类型，断言有两种形式：
::: code-group

```js [第一种方式]
let someValue: unknown = "this is a string";
let strLength: number = (someValue as string).length;
```

```js [第二种方式]
let someValue: unknown = "this is a string";
let strLength: number = (<string>someValue).length;
```

:::

使用场景：比如 `getElementById` 方法返回值的类型是 `HTMLElement`，该类型只包含所有标签公共的属性或方法，不包含 `a` 标签特有的 `href` 等属性。
因此，这个类型太宽泛（不具体），无法操作 `href` 等 `a` 标签特有的属性或方法。这种情况下就需要使用类型断言指定更加具体的类型

```js
const aLink:HTMLAnchorElement
const aLink = document.getElementById('link') as HTMLAnchorElement
```

## 非空断言

非空断言操作符 (`!`) 是 TypeScript 提供的一个类型断言语法，用于告诉 TypeScript 编译器："我确定这个值不是 null 或 undefined，请相信我"。

### 访问可能为 null/undefined 的属性

```ts
interface User {
  name?: string;
}

function getUserName(user: User): string {
  return user.name!; // 断言 name 存在
}
```

### 数组非空断言

```ts
const array: number[] | null = [1, 2, 3];
const first = array![0]; // 断言数组不为 null
```

### 函数返回值非空断言

```ts
function findUser(id: number): User | undefined {
  /* ... */
}

const user = findUser(1)!; // 断言返回值不为 undefined
```
