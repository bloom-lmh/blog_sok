# 响应处理

[[toc]]

## 配置概述

与响应处理相关的配置如下：
::: code-group

```js [通用配置]
// 【重要】自定义响应状态码验证逻辑
// 返回true则resolve，false则reject
validateStatus: function (status) {
  return status >= 200 && status < 300; // 默认只接受2xx状态码
},

```

```js [node专业配置]
// 【Node专用】响应体最大长度（字节）
maxContentLength: 2000,
// 【Node专用】是否自动解压响应体
decompress: true


```

:::

## 自定义响应状态码验证逻辑-validateStatus

`validateStatus` 是 Axios 中用于自定义响应状态码验证逻辑的重要配置项，它决定了哪些 HTTP 状态码会被认为是成功的请求（触发 `then`），哪些会触发 `catch`。

### 默认逻辑

默认情况下，Axios 使用以下验证逻辑：

```js
validateStatus: function (status) {
  return status >= 200 && status < 300; // 仅2xx状态码算成功
}
```

### 自定义验证

有时候我们希望在 then 中处理一些特殊的状态码，而不是在 catch 中我们可以使用 `validateStatus` 来改变默认的验证逻辑。比如下面的代码，小于 500 的状态码都视为成功，大于等于 500 的状态码都视为失败：

```js
axios
  .get('/api/data', {
    validateStatus: function (status) {
      return status < 500; // 将 5xx 以外的状态码都视为成功
    },
  })
  .then((response) => {
    // 2xx 和 4xx 状态码都会进入这里
    if (response.status >= 400) {
      // 处理 4xx 错误
      console.log('客户端错误:', response.status);
    } else {
      // 处理 2xx 成功响应
      console.log('成功:', response.data);
    }
  })
  .catch((error) => {
    // 只有 5xx 状态码会进入这里
    console.log('服务器错误:', error.response.status);
  });
```

### 注意事项

1. 与拦截器的执行顺序 ​：
   - validateStatus 先于响应拦截器执行
   - 如果返回 false，会直接进入错误拦截器
2. ​HTTP 协议规范 ​：
   - 虽然可以接受非 2xx 状态码为成功，但违反 HTTP 语义
   - 建议在业务逻辑层处理特殊状态码，而非通过此配置
