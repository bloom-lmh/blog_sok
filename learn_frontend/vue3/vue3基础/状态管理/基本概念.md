# 基本概念

## 简介

`Pinia` 是一个拥有组合式 API 的 `Vue` 状态管理库,同时支持 `Vue 2` 和 `Vue 3`,并且不强制要求开发者使用组合式 API

## 安装

使用 npm 安装:`npm install pinia --save`

::: tip 对于低于`2.7`版本的包
如果你的应用使用的 `Vue` 版本低于 `2.7`，你还需要安装组合式 `API` 包：`@vue/composition-api`。如果你使用的是 `Nuxt`，你应该参考这篇指南。
:::

## 最佳实践

### 理解 store

所谓的 store 就是状态管理工具，通过它可以将状态和状态对应的逻辑从组件树中抽取出来，以便于在多个组件之间共享和复用。实现了部分状态及其逻辑与组件的解耦

### 不要滥用 store

不应该过渡使用 store，store 中的状态数据应该确实在多个组件之间共享下才建立，下面展示一些必要的使用场景

1. 全局共享状态：
   - 用户登录信息（user, token）
   - 应用主题、语言偏好（theme, locale）
   - 多组件依赖的公共数据（如购物车、全局通知）
2. 跨多个不相关组件的状态：一个侧边栏的展开状态，影响头部、主内容区等多个组件。
3. 需要持久化的状态：需要保存到 localStorage 或通过 API 同步的状态。
4. 复杂业务逻辑产生的状态：经过多步计算、异步操作（如 API 调用）才得到的数据。
5. 路由无关的持久状态：即使用户跳转页面也不应丢失的状态。

## 起步

创建一个 `pinia` 实例 (根 `store`) 并将其传递给应用

```ts
import { createApp } from 'vue';
import { createPinia } from 'pinia';
import App from './App.vue';

const pinia = createPinia();
const app = createApp(App);

app.use(pinia);
app.mount('#app');
```

如果你使用的是 `Vue 2`，你还需要安装一个插件，并在应用的根部注入创建的 `pinia`

```ts
import { createPinia, PiniaVuePlugin } from 'pinia';

Vue.use(PiniaVuePlugin);
const pinia = createPinia();

new Vue({
  el: '#app',
  // 其他配置...
  // ...
  // 请注意，同一个`pinia'实例
  // 可以在同一个页面的多个 Vue 应用中使用。
  pinia,
});
```
