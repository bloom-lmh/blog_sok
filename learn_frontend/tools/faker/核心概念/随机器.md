# 随机器

[[toc]]

## 什么是随机器？

`Randomizer` 是 `Faker.js` 的底层随机数生成器，控制所有数据生成的随机性。默认情况下，`Faker` 使用内置的 `Mersenne Twister` 算法，但允许你：

​ 共享随机源 ​：多个 `Faker` 实例共用同一个 `Randomizer`，确保随机序列一致。
​ 替换第三方库 ​：集成如 `pure-rand` 等第三方随机数生成器。

## 内置 Randomizer

两种变体

- 32 位 ​：速度更快，适合高性能场景。
- ​53 位 ​：随机性更好，显著减少重复值（如批量生成邮箱时）。

```js
import {
  generateMersenne32Randomizer, // 32位（v9之前默认，速度快）
  generateMersenne53Randomizer, // 53位（v9后默认，重复率更低）
} from '@faker-js/faker';

const randomizer = generateMersenne53Randomizer(); // 推荐
```

## 核心使用场景

### 共享 Randomizer（多实例同步）

如果你有多个 Faker 实例（例如 fakerEN 和 fakerZH），并且希望它们生成的随机数据保持某种关联性（比如中文名和对应的英文名），就需要让它们的随机序列同步。

```JS
import { Faker, generateMersenne53Randomizer } from '@faker-js/faker';

// 1. 创建共享的 Randomizer
const sharedRandomizer = generateMersenne53Randomizer();

// 2. 多个 Faker 实例共用它
const fakerEN = new Faker({ locale: 'en', randomizer: sharedRandomizer });
const fakerZH = new Faker({ locale: 'zh_CN', randomizer: sharedRandomizer });

// 3. 只需播种一次，所有实例生效！
sharedRandomizer.seed(5);

// 4. 生成的数据会保持同步顺序
console.log(fakerEN.person.firstName()); // "John"（第一个英文名）
console.log(fakerZH.person.firstName()); // "伟" （第一个中文名）
console.log(fakerEN.person.lastName());  // "Doe" （第二个英文名）
console.log(fakerZH.person.lastName());  // "张"  （第二个中文名）
```

### 第三方 Randomizer（示例：pure-rand）

```js
import { Randomizer } from '@faker-js/faker';
import { xoroshiro128plus, RandomGenerator } from 'pure-rand';

function createPureRandRandomizer(seed = Date.now()) {
  let generator = xoroshiro128plus(seed);

  return {
    next: () => (generator.unsafeNext() >>> 0) / 0x100000000, // 返回 [0,1) 的浮点数
    seed: (newSeed) => { generator = xoroshiro128plus(newSeed); }
  } satisfies Randomizer;
}

const customFaker = new Faker({
  locale: 'en',
  randomizer: createPureRandRandomizer(42) // 使用第三方随机源
});
```
